<html><head><meta charset="utf-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><title>Quick Started</title><link rel="shortcut icon" type="image/x-icon" href="../favicon.ico"></link><script type="text/javascript" src="../scripts/searchData.js" defer="true"></script><link rel="stylesheet" href="../styles/nord-light.css"></link><link rel="stylesheet" href="../styles/scalastyle.css"></link><link rel="stylesheet" href="../styles/dotty-icons.css"></link><link rel="stylesheet" href="../styles/diagram.css"></link><link rel="stylesheet" href="../styles/filter-bar.css"></link><link rel="stylesheet" href="../styles/search-bar.css"></link><link rel="stylesheet" href="../styles/scaladoc-searchbar.css"></link><script type="text/javascript" src="../hljs/highlight.pack.js" defer="true"></script><script type="text/javascript" src="../scripts/hljs-scala3.js" defer="true"></script><script type="text/javascript" src="../scripts/ux.js" defer="true"></script><script type="text/javascript" src="../scripts/common/component.js" defer="true"></script><script type="text/javascript" src="../scripts/common/utils.js" defer="true"></script><script type="text/javascript" src="../scripts/components/FilterBar.js" defer="true"></script><script type="text/javascript" src="../scripts/components/DocumentableList.js" defer="true"></script><script type="text/javascript" src="../scripts/components/Input.js" defer="true"></script><script type="text/javascript" src="../scripts/components/FilterGroup.js" defer="true"></script><script type="text/javascript" src="../scripts/components/Filter.js" defer="true"></script><script type="text/javascript" src="../scripts/searchbar.js" defer="true"></script><script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js" defer="true"></script><script type="text/javascript" src="https://d3js.org/d3.v6.min.js" defer="true"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/graphlib-dot@0.6.2/dist/graphlib-dot.min.js" defer="true"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/dagre-d3/0.6.1/dagre-d3.min.js" defer="true"></script><script type="text/javascript" src="../scripts/data.js" defer="true"></script><script>var pathToRoot = "../";</script></head><body><div id="container"><div id="leftColumn"><div id="logo"><span><div class="projectName">Http4s Finagle</div></span><span><div class="projectVersion">0.21.22-21.4.0</div></span><div class="socials"></div></div><div id="paneSearch"></div><nav id="sideMenu2"><div class="expanded"><a href="#" class="selected expanded">Http4s Finagle</a><span class="ar"></span><div><a href="install.html">Installation</a></div><div><a href="quick-start.html" class="selected expanded">Quick Started</a></div><div><a href="finagle.html">Why Finagle x Http4s?</a></div><div><a href="example.html">A Production Ready Example</a></div><div><a href="../api/index.html">API</a><span class="ar"></span><div><a href="../api/org/http4s/finagle.html"><span class="micon p"></span>org.http4s.finagle</a><span class="ar"></span><div><a href="../api/org/http4s/finagle/Finagle$.html"><span class="micon o"></span>Finagle</a></div></div></div></div></nav></div><div id="main"><div id="leftToggler"><span class="icon-toggler"></span></div><div id="scaladoc-searchBar"></div><main><div id="content"><div class="breadcrumbs"><a href="#">Http4s Finagle</a>/<a href="quick-start.html">Quick Started</a></div><div><!-- This page was last generated on  --><!doctype html>
<html lang="en"> 
 <head> 
  <meta charset="utf-8"> 
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> 
  <meta http-equiv="x-ua-compatible" content="ie=edge"> 
  <title>Quick Started</title> 
  <link rel="icon" type="image/png" href="/images/favicon.png"> 
  <link rel="dns-prefetch" href="//fonts.googleapis.com"> 
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin> 
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> 
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css"> 
 </head> 
 <body> 
  <main class="container"> 
   <header> 
    <h1>Quick Started</h1> 
   </header> 
   <h2><a href="#server" id="server" class="anchor"></a>Server</h2> 
   <p>To run Http4s app on Finagle Http server, simply just use <code>Finagle.mkService</code> to adapt Http4s <code>HttpApp[F]</code> to Fingale <code>Service[Request, Response]</code>.</p> 
   <pre><code class="language-scala">import org.http4s.finagle._
import com.twitter.finagle.Http

val http4sService: HttpApp[IO] = HttpRoutes.of[IO] {...}.orNotFound

val server = Http.server.serve(":8080", Finagle.mkService(http4sService))
Await.ready(server)
</code></pre> 
   <h2><a href="#client" id="client" class="anchor"></a>Client</h2> 
   <p>To make a Finagle Client is the other way around, we need to adapt Finagle <code>Service[Request, Response]</code> to Http4s <code>Client[IO]</code>:</p> 
   <pre><code class="language-scala">import org.http4s.finagle._
import com.twitter.finagle.Http

val host = "blog.oyanglul.us"
Finagle.mkClient[IO](Http.client.withTls(host).newService(s"$host:443")).use {
  client: Client[IO] =&gt;
  ...
}
</code></pre> 
   <h3><a href="#" class="anchor"></a><img src="https://github.global.ssl.fastly.net/images/icons/emoji/warning.png" alt="emoji places:warning" height="20" width="20" align="absmiddle"></h3> 
   <p>A fundamental different from usual Http client is that finagle <code>Client[IO]</code> is actually a RPC Http client, which means it cannot send arbitrary request to any host, the host endpoint is already set when created this client. This machinism is very useful to identify endpoint healthy, load balancer, circuit breaker. But a little bit weird when using:</p> 
   <pre><code class="language-scala">val host = "blog.oyanglul.us"
Finagle.mkClient[IO](Http.client.withTls(host).newService(s"$host:443")).use {
  client: Client[IO] =&gt;
  client.status(uri"https://twiter.com")
  client.status(uri"https://abc.com/blahblah")
}
</code></pre> 
   <ul> 
    <li><code>client.status(uri"https://twiter.com")</code> will still send request to <code>https://blog.oyanglul.us</code></li> 
    <li><code>client.status(uri"https://abc.com/blahblah")</code> will send request to <code>https://blog.oyanglul.us/blahblah</code></li> 
   </ul> 
  </main>  
 </body>
</html></div></div></main><footer><span class="go-to-top-icon"><a href="#container"><span class="icon-vertical_align_top"></span>&nbsp;Back to top</a></span><div class="socials"></div><div id="generated-by">Generated by&nbsp;<a href="https://github.com/lampepfl/dotty/tree/master/scaladoc"><img src="../images/scaladoc_logo.svg" alt="scaladoc" class="scaladoc_logo"></img></a></div></footer></div></div></body></html>