<!-- This page was last generated on 2020-08-23 -->
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta http-equiv="x-ua-compatible" content="ie=edge">

        <title>Quick Started</title>

        <link rel="icon" type="image/png" href="/http4s-finagle/images/favicon.png">

        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css">
        <link rel="stylesheet" href="/http4s-finagle/css/bootstrap.min.css">
        <link rel="stylesheet" href="/http4s-finagle/css/dottydoc.css">
        <link rel="stylesheet" href="/http4s-finagle/css/color-brewer.css"><!-- hljs theme -->

        
            <link rel="stylesheet" href="/http4s-finagle/css/toolbar.css">
        
            <link rel="stylesheet" href="/http4s-finagle/css/sidebar.css">
        

        <script src="/http4s-finagle/js/jquery.min.js"></script>
    </head>
    <body>
        <header>
    <nav class="navbar navbar-expand navbar-dark fixed-top">
        <a id="menu-icon" title="Menu" aria-label="Menu">
            <i class="fas fa-bars"></i>
        </a>
        <a id="search-icon" title="Search" aria-label="Search">
            <i class="fas fa-search"></i>
        </a>
        <span id="searchbar">
            <input id="search-api-input" type="text" class="form-control" placeholder="Search API" aria-label="Search API">
            <input id="baseurl-input" type="hidden" value="">
        </span>
        <div class="navbar-brand">
            
            <a href="/http4s-finagle/docs/index.html">
                <div class="project-details">
                    <h1>Http4s Finagle Documentation</h1>
                    <h2>0.21.7-20.8.0</h2>
                </div>
            </a>
        </div>

        
        <a id="github-link" title="Project repository" href="https://github/http4s/http4s-finagle">
            
            <i class="fab fa-github" aria-hidden="true"></i>
            
        </a>
        
    </nav>
</header>

<nav class="sidebar">
    <ul class="toc">
        <!-- Redacted documents -->
        
            <li class="leaf"><a href="/http4s-finagle/docs/install.html" >Installation</a></li>
        
            <li class="leaf"><a href="/http4s-finagle/docs/quick-start.html" class="toggled">Quick Start</a></li>
        
            <li class="leaf"><a href="/http4s-finagle/docs/finagle.html" >Why Finagle?</a></li>
        
            <li class="leaf"><a href="/http4s-finagle/docs/example.html" >Production Ready Example</a></li>
        
        <!-- API documentation -->
        
        <li class="index-entities section">
            <a onclick="toggleSection(this);">API</a>
            <ul>
            
                <li class="index-entity entity-package section">
                    <a class="package-toggle" onclick="toggleSection(this);">
                        <i class="fas fa-angle-right"></i>
                    </a>
                    <a class="entity-name" href="/http4s-finagle/api/org/http4s/index.html">
                        org.http4s
                    </a>
                    <ul class="package-entities">
                        
                    </ul>
                </li>
            
                <li class="index-entity entity-package section">
                    <a class="package-toggle" onclick="toggleSection(this);">
                        <i class="fas fa-angle-right"></i>
                    </a>
                    <a class="entity-name" href="/http4s-finagle/api/org/http4s/finagle/index.html">
                        org.http4s.finagle
                    </a>
                    <ul class="package-entities">
                        
                            

                            <li class="">
                                <div class="entity-kinds">
                                    
                                    <a class="letter-anchor object" href="/http4s-finagle/api/org/http4s/finagle/Finagle$.html">O</a>
                                </div>
                                <a class="entity-name" href="/http4s-finagle/api/org/http4s/finagle/Finagle$.html">Finagle</a>
                            </li>
                            

                        
                    </ul>
                </li>
            
            </ul>
        </li>
        
    </ul>
</nav>

<div id="content-wrapper">
    <main class="container">
    <header>
        <h1>Quick Started</h1>
        <div class="byline">
            <a href="https://github/http4s/http4s-finagle/edit/master/docs/docs/quick-start.md">
                <i class="far fa-edit"></i>
                Edit this page on GitHub
            </a>
        </div>
    </header>
    <h2><a href="#server" id="server" class="anchor"></a>Server</h2>
<p>To run Http4s app on Finagle Http server, simply just use <code>Finagle.mkService</code> to adapt Http4s <code>HttpApp[F]</code> to Fingale <code>Service[Request, Response]</code>.</p>
<pre><code class="scala">import org.http4s.finagle._
import com.twitter.finagle.Http

val http4sService: HttpApp[IO] = HttpRoutes.of[IO] {...}.orNotFound

val server = Http.server.serve(&quot;:8080&quot;, Finagle.mkService(http4sService))
Await.ready(server)
</code></pre>
<h2><a href="#client" id="client" class="anchor"></a>Client</h2>
<p>To make a Finagle Client is the other way around, we need to adapt Finagle <code>Service[Request, Response]</code> to Http4s <code>Client[IO]</code>:</p>
<pre><code class="scala">import org.http4s.finagle._
import com.twitter.finagle.Http

val host = &quot;blog.oyanglul.us&quot;
Finagle.mkClient[IO](Http.client.withTls(host).newService(s&quot;$host:443&quot;)).use {
  client: Client[IO] =&gt;
  ...
}
</code></pre>
<h3><a href="#" class="anchor"></a><img src="https://github.global.ssl.fastly.net/images/icons/emoji/warning.png" alt="emoji places:warning" height="20" width="20" align="absmiddle" /></h3>
<p>A fundamental different from usual Http client is that finagle <code>Client[IO]</code> is actually a RPC Http client,
which means it cannot send arbitrary request to any host, the host endpoint is already set when created
this client. This machinism is very useful to identify endpoint healthy, load balancer, circuit breaker.
But a little bit weird when using:</p>
<pre><code class="scala">val host = &quot;blog.oyanglul.us&quot;
Finagle.mkClient[IO](Http.client.withTls(host).newService(s&quot;$host:443&quot;)).use {
  client: Client[IO] =&gt;
  client.status(uri&quot;https://twiter.com&quot;)
  client.status(uri&quot;https://abc.com/blahblah&quot;)
}
</code></pre>
<ul>
<li><code>client.status(uri&quot;https://twiter.com&quot;)</code> will still send request to <code>https://blog.oyanglul.us</code></li>
<li><code>client.status(uri&quot;https://abc.com/blahblah&quot;)</code> will send request to <code>https://blog.oyanglul.us/blahblah</code></li>
</ul>

</main>
</div>
<script>
  ((window.gitter = {}).chat = {}).options = {
    room: 'lampepfl/dotty'
  };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

        <script src="/http4s-finagle/js/highlight.pack.js"></script>
        <script src="/http4s-finagle/js/bootstrap.min.js"></script>
        
            <script src="/http4s-finagle/js/toolbar.js"></script>
        
            <script src="/http4s-finagle/js/sidebar.js"></script>
        
        <script src="/http4s-finagle/js/dottydoc.js"></script>
    </body>
</html>
